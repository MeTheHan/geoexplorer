<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoExplorer - Coƒürafya Oyunu</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .start-screen {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .start-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.5em;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .start-btn:hover {
            transform: scale(1.05);
            background: #2ecc71;
        }

        .game-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 20px;
            display: none; /* Ba≈ülangƒ±√ßta gizli */
        }

        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
            }
        }

        .location-info {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .timer-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .timer {
            background: #e74c3c;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1em;
        }

        .round-info {
            background: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 15px;
            font-weight: bold;
        }

        .target-location {
            text-align: center;
        }

        .target-location h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .location-detail {
            margin: 12px 0;
            font-size: 1.1em;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .game-panel {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .score-display {
            font-size: 2em;
            font-weight: bold;
            text-align: center;
            color: #27ae60;
            margin-bottom: 20px;
        }

        #guessMap {
            width: 100%;
            height: 400px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 3px solid #bdc3c7;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #27ae60;
            color: white;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .results-container {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .game-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }

        .stat-card {
            background: #34495e;
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .welcome-text {
            font-size: 1.2em;
            line-height: 1.6;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .instructions {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: left;
        }

        .instructions h3 {
            color: #2980b9;
            margin-bottom: 10px;
        }

        .instructions ul {
            padding-left: 20px;
        }

        .instructions li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç GeoExplorer</h1>
            <p>D√ºnya Coƒürafyasƒ±nƒ± Ke≈üfet!</p>
        </div>
        
        <!-- BA≈ûLANGI√á EKRANI -->
        <div class="start-screen" id="startScreen">
            <h2>Coƒürafya Oyununa Ho≈ü Geldiniz! üéØ</h2>
            <div class="welcome-text">
                <p>Rastgele bir d√ºnya lokasyonu verilecek ve siz bu lokasyonu harita √ºzerinde bulmaya √ßalƒ±≈üacaksƒ±nƒ±z.</p>
            </div>
            
            <div class="instructions">
                <h3>üìã Nasƒ±l Oynanƒ±r:</h3>
                <ul>
                    <li>Ekranda g√∂sterilen ≈üehir/√ºlkeyi haritada bulun</li>
                    <li>Haritaya tƒ±klayarak tahmininizi i≈üaretleyin</li>
                    <li>Ne kadar yakƒ±n olursanƒ±z o kadar √ßok puan alƒ±rsƒ±nƒ±z</li>
                    <li>Toplam 5 raunt √ºzerinden oynanƒ±r</li>
                    <li>Her raunt i√ßin 2 dakika s√ºreniz var</li>
                </ul>
            </div>
            
            <button class="start-btn" onclick="startGame()">
                üöÄ OYUNU BA≈ûLAT
            </button>
        </div>
        
        <!-- OYUN EKRANI -->
        <div class="game-container" id="gameContainer">
            <div class="location-info">
                <div class="timer-container">
                    <div class="timer" id="timer">02:00</div>
                    <div class="round-info">
                        <span id="roundText">Raunt</span> <span id="roundNumber">1</span>/<span id="totalRounds">5</span>
                    </div>
                </div>
                
                <div class="target-location">
                    <h2 id="locationName">-</h2>
                    <div class="location-detail">
                        <strong>üìç Konum:</strong> <span id="cityCountry">-</span>
                    </div>
                    <div class="location-detail">
                        <strong>üåê Kƒ±ta:</strong> <span id="continentValue">-</span>
                    </div>
                    <div class="location-detail">
                        <strong>üìê Koordinatlar:</strong> <span id="coordinatesValue">-</span>
                    </div>
                </div>
            </div>
            
            <div class="game-panel">
                <div class="score-display">
                    <span id="totalScore">0</span> <span id="pointsText">Puan</span>
                </div>
                
                <div id="guessMap"></div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" id="guessBtn" onclick="makeGuess()">
                        üìç <span id="guessText">Tahminimi Onayla</span>
                    </button>
                    <button class="btn btn-secondary" onclick="skipLocation()">
                        ‚è≠Ô∏è <span id="skipText">Ge√ß</span>
                    </button>
                </div>
                
                <div class="results-container" id="resultsContainer">
                    <div class="distance-score" id="distanceScore"></div>
                    <div class="location-details" id="locationDetails"></div>
                </div>
                
                <button class="btn btn-primary" id="nextRoundBtn" onclick="nextRound()" style="display: none; width: 100%;">
                    ‚û°Ô∏è <span id="nextRoundText">Sonraki Raunt</span>
                </button>
                
                <div class="game-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="accuracy">0%</div>
                        <div class="stat-label" id="accuracyText">Doƒüruluk</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgDistance">- km</div>
                        <div class="stat-label" id="distanceText">Ort. Mesafe</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="foundCount">0</div>
                        <div class="stat-label" id="foundText">Bulunan</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // GER√áEK D√úNYA LOKASYONLARI
        const worldLocations = [
            // T√ºrkiye
            { lat: 41.0082, lng: 28.9784, city: "ƒ∞stanbul", country: "T√ºrkiye", continent: "Avrupa" },
            { lat: 39.9334, lng: 32.8597, city: "Ankara", country: "T√ºrkiye", continent: "Avrupa" },
            { lat: 38.4192, lng: 27.1287, city: "ƒ∞zmir", country: "T√ºrkiye", continent: "Avrupa" },
            { lat: 36.8841, lng: 30.7056, city: "Antalya", country: "T√ºrkiye", continent: "Avrupa" },
            { lat: 40.1885, lng: 29.0610, city: "Bursa", country: "T√ºrkiye", continent: "Avrupa" },
            
            // Avrupa
            { lat: 48.8566, lng: 2.3522, city: "Paris", country: "Fransa", continent: "Avrupa" },
            { lat: 51.5074, lng: -0.1278, city: "Londra", country: "ƒ∞ngiltere", continent: "Avrupa" },
            { lat: 52.5200, lng: 13.4050, city: "Berlin", country: "Almanya", continent: "Avrupa" },
            { lat: 41.9028, lng: 12.4964, city: "Roma", country: "ƒ∞talya", continent: "Avrupa" },
            { lat: 40.4168, lng: -3.7038, city: "Madrid", country: "ƒ∞spanya", continent: "Avrupa" },
            { lat: 52.3676, lng: 4.9041, city: "Amsterdam", country: "Hollanda", continent: "Avrupa" },
            { lat: 59.3293, lng: 18.0686, city: "Stokholm", country: "ƒ∞sve√ß", continent: "Avrupa" },
            
            // Asya
            { lat: 35.6762, lng: 139.6503, city: "Tokyo", country: "Japonya", continent: "Asya" },
            { lat: 39.9042, lng: 116.4074, city: "Pekin", country: "√áin", continent: "Asya" },
            { lat: 28.6139, lng: 77.2090, city: "Yeni Delhi", country: "Hindistan", continent: "Asya" },
            { lat: 37.5665, lng: 126.9780, city: "Seul", country: "G√ºney Kore", continent: "Asya" },
            { lat: 13.7563, lng: 100.5018, city: "Bangkok", country: "Tayland", continent: "Asya" },
            { lat: 1.3521, lng: 103.8198, city: "Singapur", country: "Singapur", continent: "Asya" },
            
            // Kuzey Amerika
            { lat: 40.7128, lng: -74.0060, city: "New York", country: "ABD", continent: "Kuzey Amerika" },
            { lat: 34.0522, lng: -118.2437, city: "Los Angeles", country: "ABD", continent: "Kuzey Amerika" },
            { lat: 41.8781, lng: -87.6298, city: "Chicago", country: "ABD", continent: "Kuzey Amerika" },
            { lat: 43.6532, lng: -79.3832, city: "Toronto", country: "Kanada", continent: "Kuzey Amerika" },
            { lat: 19.4326, lng: -99.1332, city: "Mexico City", country: "Meksika", continent: "Kuzey Amerika" },
            
            // G√ºney Amerika
            { lat: -23.5505, lng: -46.6333, city: "S√£o Paulo", country: "Brezilya", continent: "G√ºney Amerika" },
            { lat: -34.6037, lng: -58.3816, city: "Buenos Aires", country: "Arjantin", continent: "G√ºney Amerika" },
            { lat: -12.0464, lng: -77.0428, city: "Lima", country: "Peru", continent: "G√ºney Amerika" },
            { lat: 4.7110, lng: -74.0721, city: "Bogot√°", country: "Kolombiya", continent: "G√ºney Amerika" },
            
            // Afrika
            { lat: 30.0444, lng: 31.2357, city: "Kahire", country: "Mƒ±sƒ±r", continent: "Afrika" },
            { lat: 33.9249, lng: 18.4241, city: "Cape Town", country: "G√ºney Afrika", continent: "Afrika" },
            { lat: 6.5244, lng: 3.3792, city: "Lagos", country: "Nijerya", continent: "Afrika" },
            { lat: -1.2921, lng: 36.8219, city: "Nairobi", country: "Kenya", continent: "Afrika" },
            
            // Okyanusya
            { lat: -33.8688, lng: 151.2093, city: "Sidney", country: "Avustralya", continent: "Okyanusya" },
            { lat: -37.8136, lng: 144.9631, city: "Melbourne", country: "Avustralya", continent: "Okyanusya" },
            { lat: -36.8485, lng: 174.7633, city: "Auckland", country: "Yeni Zelanda", continent: "Okyanusya" }
        ];

        let map;
        let guessMarker = null;
        let timerInterval;
        let currentLocation = null;
        let playerGuess = null;
        let gameState = {
            currentRound: 1,
            totalScore: 0,
            roundActive: false, // Ba≈ülangƒ±√ßta false
            timer: 120,
            roundScores: [],
            roundDistances: [],
            foundCount: 0,
            totalRounds: 5,
            gameStarted: false
        };

        // Oyunu ba≈ülat
        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'grid';
            
            initMap();
            startRound();
        }

        function initMap() {
            map = L.map('guessMap').setView([20, 0], 2);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
            
            map.on('click', function(e) {
                if (!gameState.roundActive) return;
                
                if (guessMarker) {
                    map.removeLayer(guessMarker);
                }
                
                guessMarker = L.marker(e.latlng).addTo(map)
                    .bindPopup(`üìç Tahmininiz: ${e.latlng.lat.toFixed(4)}, ${e.latlng.lng.toFixed(4)}`)
                    .openPopup();
                
                playerGuess = e.latlng;
                document.getElementById('guessBtn').disabled = false;
            });
        }

        function getRandomLocation() {
            // Diziden rastgele bir lokasyon se√ß
            const randomIndex = Math.floor(Math.random() * worldLocations.length);
            return worldLocations[randomIndex];
        }

        function startRound() {
            gameState.roundActive = true;
            gameState.gameStarted = true;
            playerGuess = null;
            gameState.timer = 120;
            
            // RASTGELE GER√áEK LOKASYON
            currentLocation = getRandomLocation();
            
            // EKRANDA G√ñSTER
            document.getElementById('locationName').textContent = `${currentLocation.city}`;
            document.getElementById('cityCountry').textContent = `${currentLocation.city}, ${currentLocation.country}`;
            document.getElementById('continentValue').textContent = currentLocation.continent;
            document.getElementById('coordinatesValue').textContent = `${currentLocation.lat.toFixed(4)}, ${currentLocation.lng.toFixed(4)}`;
            
            // HARƒ∞TAYI SIFIRLA
            if (guessMarker) {
                map.removeLayer(guessMarker);
                guessMarker = null;
            }
            map.setView([20, 0], 2);
            
            // BUTONLARI SIFIRLA
            document.getElementById('guessBtn').disabled = true;
            document.getElementById('resultsContainer').style.display = 'none';
            document.getElementById('nextRoundBtn').style.display = 'none';
            document.getElementById('guessBtn').style.display = 'block';
            
            // ZAMANLAYICIYI BA≈ûLAT
            startTimer();
            
            // RAUNT Bƒ∞LGƒ∞Sƒ∞
            document.getElementById('roundNumber').textContent = gameState.currentRound;
            document.getElementById('totalRounds').textContent = gameState.totalRounds;
        }

        function startTimer() {
            updateTimerDisplay();
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                gameState.timer--;
                updateTimerDisplay();
                
                if (gameState.timer <= 0) {
                    clearInterval(timerInterval);
                    if (gameState.roundActive) {
                        makeGuess();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.timer / 60);
            const seconds = gameState.timer % 60;
            const timerElement = document.getElementById('timer');
            timerElement.textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
            // Son 10 saniyede kƒ±rmƒ±zƒ±
            if (gameState.timer <= 10) {
                timerElement.style.background = '#e74c3c';
            } else {
                timerElement.style.background = '#e74c3c';
            }
        }

        function makeGuess() {
            if (!playerGuess || !gameState.roundActive) return;
            
            gameState.roundActive = false;
            clearInterval(timerInterval);
            
            const distance = calculateDistance(
                playerGuess.lat, playerGuess.lng,
                currentLocation.lat, currentLocation.lng
            );
            
            const score = calculateScore(distance);
            gameState.totalScore += score;
            gameState.roundScores.push(score);
            gameState.roundDistances.push(distance);
            gameState.foundCount++;
            
            showResults(distance, score);
            updateStats();
        }

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371;
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                    Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        function calculateScore(distance) {
            if (distance < 50) return 5000;
            if (distance < 100) return 4500;
            if (distance < 200) return 4000;
            if (distance < 500) return 3500;
            if (distance < 1000) return 3000;
            if (distance < 2000) return 2000;
            if (distance < 5000) return 1000;
            return 500;
        }

        function showResults(distance, score) {
            const resultsContainer = document.getElementById('resultsContainer');
            const distanceScore = document.getElementById('distanceScore');
            const locationDetails = document.getElementById('locationDetails');
            
            distanceScore.innerHTML = `
                <span style="color: ${score > 2500 ? '#27ae60' : score > 1000 ? '#f39c12' : '#e74c3c'}; font-size: 1.2em;">
                    ${score} Puan ‚Ä¢ ${distance.toFixed(1)} km uzakta
                </span>
            `;
            locationDetails.innerHTML = `
                <strong>üéØ Ger√ßek Konum: ${currentLocation.city}, ${currentLocation.country}</strong><br>
                <span style="color: #7f8c8d;">Kƒ±ta: ${currentLocation.continent} ‚Ä¢ Koordinatlar: ${currentLocation.lat.toFixed(4)}, ${currentLocation.lng.toFixed(4)}</span>
            `;
            
            // Ger√ßek konumu haritada g√∂ster
            L.marker([currentLocation.lat, currentLocation.lng], {
                icon: new L.Icon({
                    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                    iconSize: [25, 41],
                    iconAnchor: [12, 41],
                    popupAnchor: [1, -34],
                    shadowSize: [41, 41]
                })
            }).addTo(map).bindPopup(`üéØ ${currentLocation.city}, ${currentLocation.country}`).openPopup();
            
            resultsContainer.style.display = 'block';
            document.getElementById('guessBtn').style.display = 'none';
            document.getElementById('nextRoundBtn').style.display = 'block';
        }

        function skipLocation() {
            if (!gameState.roundActive) return;
            gameState.roundActive = false;
            clearInterval(timerInterval);
            
            showResults(0, 0);
            updateStats();
        }

        function nextRound() {
            gameState.currentRound++;
            
            if (gameState.currentRound > gameState.totalRounds) {
                endGame();
            } else {
                startRound();
            }
        }

        function endGame() {
            const avgDistance = calculateAverageDistance();
            const accuracy = calculateAccuracy();
            
            alert(`üéâ Oyun Tamamlandƒ±!\n\nFinal Skorun: ${gameState.totalScore}\nOrtalama Mesafe: ${avgDistance.toFixed(1)} km\nDoƒüruluk Oranƒ±: ${accuracy}%`);
            
            // Oyunu sƒ±fƒ±rla
            gameState = {
                currentRound: 1,
                totalScore: 0,
                roundActive: false,
                timer: 120,
                roundScores: [],
                roundDistances: [],
                foundCount: 0,
                totalRounds: 5,
                gameStarted: false
            };
            
            // Ba≈ülangƒ±√ß ekranƒ±na d√∂n
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('gameContainer').style.display = 'none';
            
            updateStats();
        }

        function updateStats() {
            document.getElementById('totalScore').textContent = gameState.totalScore;
            document.getElementById('accuracy').textContent = calculateAccuracy() + '%';
            document.getElementById('avgDistance').textContent = calculateAverageDistance().toFixed(1) + ' km';
            document.getElementById('foundCount').textContent = gameState.foundCount;
        }

        function calculateAccuracy() {
            if (gameState.roundScores.length === 0) return 0;
            const avgScore = gameState.roundScores.reduce((a, b) => a + b, 0) / gameState.roundScores.length;
            return Math.round((avgScore / 5000) * 100);
        }

        function calculateAverageDistance() {
            if (gameState.roundDistances.length === 0) return 0;
            return gameState.roundDistances.reduce((a, b) => a + b, 0) / gameState.roundDistances.length;
        }
    </script>
</body>
</html>
